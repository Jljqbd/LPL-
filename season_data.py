import requests
import json
import numpy as np
import pandas as pd
import openpyxl
headers = {
   'Accept': 'application/json, text/javascript, */*; q=0.01',
   'Accept-Encoding': 'gzip, deflate, br',
   'Accept-Language': 'zh-CN,zh;q=0.9',
   'Cache-Control': 'max-age=0',
   'Content-Length': '4718',
   'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',
   'Cookie': 'isShown=1; CNZZDATA1275078652=1283438632-1586077904-%7C1586683515; wanplus_csrf=_csrf_tk_2016192521; wp_info=ssid=s1937769960; Hm_lpvt_f69cb5ec253c6012b2aa449fb925c1c2=1586687936; gameType=2; wanplus_token=592861eee94fb1d4715ed99f21a452ab; wp_pvid=1037503182; wanplus_storage=lf4m67eka3o; UM_distinctid=17149e13af7ea-0d8dd2eb38dccf-71415a3b-100200-17149e13af82a0; Hm_lvt_f69cb5ec253c6012b2aa449fb925c1c2=1586479603,1586481689,1586590369,1586687936; wanplus_sid=0cd1006fb6ba84fee9f5c544442ab265',
   'Host': 'www.wanplus.com',
   'Origin': 'https://www.wanplus.com',
   'Referer': 'https://www.wanplus.com/lol/teamstats',
   'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36 Edge/18.18362',
   'X-CSRF-Token': '2083301385',
   'X-Requested-With': 'XMLHttpRequest',
}
#2019年LPL夏季赛数据
form ={
    
   '_gtk': '2083301385',
   'area': '' , 
   'columns%5B0%5D%5Bdata%5D': 'order',
   'columns%5B0%5D%5Bname%5D':  '',
   'columns%5B0%5D%5Borderable%5D':'false',
   'columns%5B0%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B0%5D%5Bsearch%5D%5Bvalue%5D': '' , 
   'columns%5B0%5D%5Bsearchable%5D':'true',
   'columns%5B1%5D%5Bdata%5D':'teamname',
   'columns%5B1%5D%5Bname%5D': '' , 
   'columns%5B1%5D%5Borderable%5D':'false',
   'columns%5B1%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B1%5D%5Bsearch%5D%5Bvalue%5D': '' , 
   'columns%5B1%5D%5Bsearchable%5D':'true',
   'columns%5B10%5D%5Bdata%5D':'lasthitPermin',
   'columns%5B10%5D%5Bname%5D': '' , 
   'columns%5B10%5D%5Borderable%5D':'true',
   'columns%5B10%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B10%5D%5Bsearch%5D%5Bvalue%5D': '' , 
   'columns%5B10%5D%5Bsearchable%5D':'true',
   'columns%5B11%5D%5Bdata%5D':'dragonkillsPergame',
   'columns%5B11%5D%5Bname%5D': '' , 
   'columns%5B11%5D%5Borderable%5D':'true',
   'columns%5B11%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B11%5D%5Bsearch%5D%5Bvalue%5D': '' , 
   'columns%5B11%5D%5Bsearchable%5D':'true',
   'columns%5B12%5D%5Bdata%5D':'dragonkillspercentage',
   'columns%5B12%5D%5Bname%5D': '' , 
   'columns%5B12%5D%5Borderable%5D':'true',
   'columns%5B12%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B12%5D%5Bsearch%5D%5Bvalue%5D': '' ,
   'columns%5B12%5D%5Bsearchable%5D':'true',
   'columns%5B13%5D%5Bdata%5D':'baronkillsPergame',
   'columns%5B13%5D%5Bname%5D': '' , 
   'columns%5B13%5D%5Borderable%5D':'true',
   'columns%5B13%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B13%5D%5Bsearch%5D%5Bvalue%5D': '' ,
   'columns%5B13%5D%5Bsearchable%5D':'true',
   'columns%5B14%5D%5Bdata%5D':'baronkillspercentage',
   'columns%5B14%5D%5Bname%5D': '' , 
   'columns%5B14%5D%5Borderable%5D':'true',
   'columns%5B14%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B14%5D%5Bsearch%5D%5Bvalue%5D': '' ,
   'columns%5B14%5D%5Bsearchable%5D':'true',
   'columns%5B15%5D%5Bdata%5D':'wardsplacedpermin',
   'columns%5B15%5D%5Bname%5D': '' , 
   'columns%5B15%5D%5Borderable%5D':'true',
   'columns%5B15%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B15%5D%5Bsearch%5D%5Bvalue%5D': '' ,
   'columns%5B15%5D%5Bsearchable%5D':'true',
   'columns%5B16%5D%5Bdata%5D':'wardskilledpermin',
   'columns%5B16%5D%5Bname%5D': '' , 
   'columns%5B16%5D%5Borderable%5D':'true',
   'columns%5B16%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B16%5D%5Bsearch%5D%5Bvalue%5D': '' ,
   'columns%5B16%5D%5Bsearchable%5D':'true',
   'columns%5B17%5D%5Bdata%5D':'wardskilledrate',
   'columns%5B17%5D%5Bname%5D': '' , 
   'columns%5B17%5D%5Borderable%5D':'true',
   'columns%5B17%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B17%5D%5Bsearch%5D%5Bvalue%5D': '' , 
   'columns%5B17%5D%5Bsearchable%5D':'true',
   'columns%5B18%5D%5Bdata%5D':'towertakensPergame',
   'columns%5B18%5D%5Bname%5D': '' , 
   'columns%5B18%5D%5Borderable%5D':'true',
   'columns%5B18%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B18%5D%5Bsearch%5D%5Bvalue%5D': '' ,
   'columns%5B18%5D%5Bsearchable%5D':'true',
   'columns%5B19%5D%5Bdata%5D':'towerdeathsPergame',
   'columns%5B19%5D%5Bname%5D': '' , 
   'columns%5B19%5D%5Borderable%5D':'true',
   'columns%5B19%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B19%5D%5Bsearch%5D%5Bvalue%5D': '' ,
   'columns%5B19%5D%5Bsearchable%5D':'true',
   'columns%5B2%5D%5Bdata%5D':'kda',
   'columns%5B2%5D%5Bname%5D': '' , 
   'columns%5B2%5D%5Borderable%5D':'true',
   'columns%5B2%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B2%5D%5Bsearch%5D%5Bvalue%5D': '' , 
   'columns%5B2%5D%5Bsearchable%5D':'true',
   'columns%5B3%5D%5Bdata%5D':'killsPergame',
   'columns%5B3%5D%5Bname%5D': '' , 
   'columns%5B3%5D%5Borderable%5D':'true',
   'columns%5B3%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B3%5D%5Bsearch%5D%5Bvalue%5D': '' , 
   'columns%5B3%5D%5Bsearchable%5D':'true',
   'columns%5B4%5D%5Bdata%5D':'deathsPergame',
   'columns%5B4%5D%5Bname%5D': '' , 
   'columns%5B4%5D%5Borderable%5D':'true',
   'columns%5B4%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B4%5D%5Bsearch%5D%5Bvalue%5D': '' , 
   'columns%5B4%5D%5Bsearchable%5D':'true',
   'columns%5B5%5D%5Bdata%5D':'damagetoheroPermin',
   'columns%5B5%5D%5Bname%5D': '' , 
   'columns%5B5%5D%5Borderable%5D':'true',
   'columns%5B5%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B5%5D%5Bsearch%5D%5Bvalue%5D': '' , 
   'columns%5B5%5D%5Bsearchable%5D':'true',
   'columns%5B6%5D%5Bdata%5D':'fstbloodpercentage',
   'columns%5B6%5D%5Bname%5D': '' , 
   'columns%5B6%5D%5Borderable%5D':'true',
   'columns%5B6%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B6%5D%5Bsearch%5D%5Bvalue%5D': '' , 
   'columns%5B6%5D%5Bsearchable%5D':'true',
   'columns%5B7%5D%5Bdata%5D':'avgDuration',
   'columns%5B7%5D%5Bname%5D': '' , 
   'columns%5B7%5D%5Borderable%5D':'true',
   'columns%5B7%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B7%5D%5Bsearch%5D%5Bvalue%5D': '' , 
   'columns%5B7%5D%5Bsearchable%5D':'true',
   'columns%5B8%5D%5Bdata%5D':'goldpermatch',
   'columns%5B8%5D%5Bname%5D': '' ,
   'columns%5B8%5D%5Borderable%5D':'true',
   'columns%5B8%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B8%5D%5Bsearch%5D%5Bvalue%5D': '' , 
   'columns%5B8%5D%5Bsearchable%5D':'true',
   'columns%5B9%5D%5Bdata%5D':'goldsPermin',
   'columns%5B9%5D%5Bname%5D': '' , 
   'columns%5B9%5D%5Borderable%5D':'true',
   'columns%5B9%5D%5Bsearch%5D%5Bregex%5D':'false',
   'columns%5B9%5D%5Bsearch%5D%5Bvalue%5D': '' , 
   'columns%5B9%5D%5Bsearchable%5D':'true',
   'draw':'2',
   'eid':'817',
   'filter':'%7B%22team%22%3A%7B%7D%2C%22player%22%3A%7B%7D%2C%22meta%22%3A%7B%7D%7D',
   'gametype':'2',
   'length':'20',
   'order%5B0%5D%5Bcolumn%5D':'2',
   'order%5B0%5D%5Bdir%5D':'desc',
   'search%5Bregex%5D':'false',
   'search%5Bvalue%5D': '' , 
   'start':'0',
   'type':'team',
}
url = "https://www.wanplus.com/ajax/stats/list"
data = requests.post(url, data = form, headers = headers)
json_data = json.loads(data.text)
print(json_data)